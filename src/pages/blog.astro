---
import Layout from '@/layouts/Layout.astro'
import { getCollection } from 'astro:content'
import NewsletterSection from '@/components/NewsletterSection.astro'
import DatePresenter from '@/components/DatePresenter.astro'

const allPosts = await getCollection('posts')
const posts = allPosts.sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime(),
)
---

<Layout title="Astro Portfolio Starter">
  <section
    class="mx-auto max-w-3xl dark:text-gray-100 mt-40 px-4 xl:px-0 mb-20"
  >
    <div class="posts divide-y divide:gray-400 dark:divide-gray-700">
      {
        posts.map(post => (
          <div class="post py-8">
            <h2 class="text-3xl font-bold">
              <a
                href={`/posts/${post.slug}`}
                class="hover:text-gray-500 dark:hover:text-gray-300"
              >
                {post.data.title}
              </a>
            </h2>
            <div class="text-base flex gap-2 mt-1">
              <DatePresenter date={post.data.date} />
            </div>
            <div class="line-clamp-3 text-gray-600 dark:text-gray-300 mt-4">
              {post.data.summary}
            </div>
            <div class="mt-4">
              <a
                href={`/posts/${post.slug}`}
                class="font-bold uppercase hover:text-gray-500 dark:hover:text-gray-300"
              >
                Read More
              </a>
            </div>
          </div>
        ))
      }
    </div>
  </section>

  <NewsletterSection alternateDark={true} />
</Layout>
